# これは何？

箱庭の時刻同期機能について、定量評価を行います。

# 目的

箱庭コア機能実装が、箱庭時刻同期の定義に従い、シミュレーションにおける時刻同期が適切に行われていることを確認することを目的とする。本評価では、複数の箱庭アセットがシミュレーション内で時刻同期されている際、最大許容遅延時間やアセット数を変化させた場合の挙動を測定し、定義通りの動作が確認できるかを検証する。

具体的には、以下の2点を重点的に確認する。

* 時刻同期の精度：箱庭時刻と各箱庭アセット時刻の差が定義された最大許容時間範囲内に収まっているか。
* シミュレーションの実行速度：アセット数の増加や最大許容遅延時間に応じたシミュレーション速度の変化が想定通りであるか。


# 測定内容

本測定では、箱庭時刻同期の定義に基づき、箱庭コア時刻と各箱庭アセットの時刻が許容範囲内で同期しているかを確認します。また、最大許容遅延時間や箱庭アセット数を変化させた際の挙動も評価します。

**測定項目**:
1. **箱庭時刻とアセット時刻の差**：箱庭コアの時刻と各アセットの時刻が、定義された最大許容遅延時間内に収まっているかを確認します。これは、箱庭時刻と各アセット時刻の差が許容される範囲内に収まっているかで評価します。

2. **シミュレーション実行時間**：箱庭アセット数や最大許容遅延時間が変化した際、シミュレーションの実行時間がどのように変わるかを測定します。これにより、並行動作の効率やシミュレーション速度の影響を評価します。

**パラメータ設定**:
- ステップ時間：10msec
- ステップ数：1,000ステップ（合計シミュレーション時間 10秒）

**可変パラメータ**:
- 最大許容遅延時間：10msec, 20msec, 40msec, 80msec, 100msec
- 箱庭アセット数：1, 2, 4, 8, 10

**測定方法**:
1. 各パラメータ設定に対して、箱庭時刻と各アセット時刻の記録し、最大許容遅延時間内に収まっているかを確認します。
2. 同時に、各シミュレーション実行にかかる総時間を計測し、最大許容遅延時間とアセット数に応じた並行動作の効率を評価します。

# 測定条件と測定項目

## 測定条件

- サンプル数：10件
- 箱庭アセット：Python版の箱庭アセットを利用する
- 箱庭アセットの処理内容：1ステップ毎に10,000回ビジーループする

## 測定項目

- 箱庭時刻および箱庭アセット毎の時刻
- (箱庭時刻 - 箱庭アセット時刻)の平均値
- (箱庭時刻 - 箱庭アセット時刻)の標準偏差

# 測定環境

- M2 MacBook Pro

# 期待値

測定結果が箱庭時刻同期の定義に基づいているかどうかを確認するために、以下の期待値を設定する。

1. **(箱庭時刻 - 箱庭アセット時刻)の平均値**  
   各箱庭アセットの時刻が箱庭コア時刻と同期している場合、この差の平均値は「0」に近い値を示すことが期待される。最大許容遅延時間の範囲内であれば、アセット数や遅延時間が増加しても、平均値が大きく逸脱することはない。

   **期待値**:  
   - 各パラメータ設定において、箱庭時刻とアセット時刻の差が最大許容遅延時間以下であること。
   - 箱庭アセット数の増加に伴い、若干の遅延が発生するが、同様に最大許容遅延時間であること。

2. **(箱庭時刻 - 箱庭アセット時刻)の標準偏差**  
   箱庭時刻同期の精度が高い場合、各アセット時刻間のばらつき（標準偏差）は小さくなると予測される。特に最大許容遅延時間が小さい設定では、標準偏差も小さくなる傾向が期待される。一方で、箱庭時刻同期の精度を下げた場合は、各アセット時刻間のばらつき（標準偏差）は大きくなるが、実行処理速度は向上することが期待される。

   **期待値**:  
   - 最大許容遅延時間が小さい設定では、標準偏差が小さいこと。
   - アセット数が増えるにつれて標準偏差は増加するが、箱庭時刻同期の許容範囲内に収まっていること。
   - 最大許容遅延時間が大きい場合、標準偏差が若干大きくなるが、並行動作の効率を維持できる程度であること。


# 評価基準

測定結果が期待値と一致している場合、以下の点が確認されることを目指す。
- 箱庭時刻とアセット時刻の差が、最大許容遅延時間内に収まっていること。
- 箱庭アセット数の増加や許容遅延時間の変動が、シミュレーション全体の実行速度や精度に大きな影響を及ぼさないこと。
- 並行動作の効率が、許容範囲内で保たれていること。


# 測定結果

TODO

# 評価

TODO

# 環境構築手順

TODO

# 測定手順

TODO

